
<div class="container container-custom text-center"> 
   <div class="row justify-content-center align-items-center mt-3 mb-4">
    <div class="col-auto">
      <div class="navbar-brand"> <h6 style="color: rgb(90, 87, 87);">Stock Search</h6></div>
    </div>
  </div>
  <div class="row justify-content-center mt-2">
    <div class="col-auto">
      <div class="d-flex justify-content-center">
        <div class="input-group" style="border: 3px solid blue; border-radius: 20px; width: 300px; height: 30px;">
          &nbsp;&nbsp;
          <input #searchInput type="text" class="form-control" placeholder="Search" aria-label="Search" style="border: none; height: 25px;" [(ngModel)]="storedSearchInput" matInput [formControl]="myControl" [matAutocomplete]="auto"  (keydown.enter)="getMethod(searchInput.value)"  >
         
          <button class="btn btn-outline-secondary" type="button" style="border: none; height: 30px;" (click)="getMethod(searchInput.value)">
            <img src="../assets/search.svg" height="15px" width="15px" style="margin-bottom: 15px;">
          </button>
          <button class="btn btn-outline-secondary" type="button" style="border: none; height: 30px;" (click)="cancelMethod()" >
            <img src="../assets/cancel.svg" height="20px" width="20px" style="margin-bottom: 15px;">
          </button>
        </div>
        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onOptionSelected($event)">
            <mat-option *ngIf="cursonloading" >
              <mat-spinner diameter="30"></mat-spinner>
          </mat-option>
         
          <mat-option *ngFor="let option of filteredOptions | async" [value]="option.displaySymbol">
               
            {{ option.displaySymbol }} | {{option.description}}
          </mat-option>
          
        </mat-autocomplete>
        
        
      </div>
    </div>
  </div>
  <div  *ngIf="stockLoading" class="d-flex justify-content-center my-5">
  <mat-spinner></mat-spinner>
</div>
  

<div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
    {{ errorMessage }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  
</div>



<div *ngIf="watchlistmsg" [ngClass]="color" class="alert alert-dismissible fade show mt-3" role="alert">
  {{ watchlistmsg }}
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>

</div>




<div *ngIf="showSuccess && searchResult" class="alert alert-success alert-dismissible fade show mt-3" role="alert">
  Added {{searchResult.ticker}} to watchlist 
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<div *ngIf="showDanger" class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
  <strong>Removed!</strong> This item has been removed from favorites.
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>



  <div *ngIf="searchResult &&!stockLoading && (searchResult | json) !== '{}' " class="row align-items-start mt-4 mycontainer">
  
  <div class="col text-center">
    <h6><p class="mt-0 mb-0">{{ searchResult.ticker }}
      
      <i class="bi bi-star" [ngStyle]="{'color': isFilled ? '#FFD700' : 'black'}" (click)="toggleFill()"  [class.bi-star-fill]="isFilled" [class.bi-star]="!isFilled"></i>

      
    </p></h6>
     
    
   <h6><p class="mt-0 mb-0" style="color: rgb(144, 141, 141);">{{ searchResult.name }}</p></h6>
   <p class="mt-0 mb-0" style=" font-size: 8px;color: rgb(144, 141, 141);">{{ searchResult.exchange }}</p>
   <button _ngcontent-fci-c3=""  (click)="openModalbuy()" type="button" class="btn btn-success" style="font-size: 10px;" height="" width="10px">Buy</button> &nbsp;
   <button _ngcontent-fci-c3="" *ngIf="displaySellButton"  (click)="openModalsell()" type="button" class="btn btn-danger" style="font-size: 10px;" height="" width="10px">Sell</button>
    </div>
  <div class="col text-center">
    <img src="{{ searchResult.logo }}" height="50px" width="50px" alt="no image"> 
    <p [style.color]="marketStatusColor" style="font-size: 10px;" class="mt-2">
      {{ marketStatus }} 
     
      <span *ngIf="marketStatus === 'Market is Closed'">Last close time: {{ searchResult2.t * 1000 | date:'MMM d, y, h:mm a' }}</span>
      
  
  </div>
  <div class="col text-center">
    <p class="mt-3 mb-0" [ngClass]="{'text-green': searchResult2.d >= 0, 'text-red': searchResult2.d < 0}">
        {{ searchResult2.c }}
    </p>
    <p class="mt-0" [ngClass]="{'text-green': searchResult2.d >= 0, 'text-red': searchResult2.d < 0}">
        {{ searchResult2.d }} ({{ searchResult2.dp.toFixed(2)}}%)
    </p>

    <p style="color:grey ;"  style="font-size: 10px;" class="mt-2">
       {{ currentDateTime }}
    </p>

</div>
<div class="container">
  

  <div class="row">
    <div class="col">
      <mat-tab-group animationDuration="0ms" class="mb-4">
        <mat-tab label="Summary">

          <div class="container">
            <div class="row">
             
              <div class="col-12 col-md-6">
                <h2 >{{ searchResult2.name }}</h2>
                <p class="text-md-start" style="font-size: small;"><strong>High Price:</strong> {{ searchResult2.h }}</p>
                <p class="text-md-start" style="font-size: small;"><strong>Low Price:</strong> {{ searchResult2.l }}</p>
                <p class="text-md-start" style="font-size: small;"><strong>Open Price:</strong> {{ searchResult2.o }}</p>
                <p class="text-md-start" style="font-size: small;"><strong>Previous Close:</strong> {{ searchResult2.pc }}</p>
                
                <div>
                  <h3>About the company</h3>
                  <p style="font-size: small;"><strong>IPO Start Date:</strong> {{ searchResult.ipo }}</p>
                  <p style="font-size: small;"><strong>Industry:</strong> {{ searchResult.finnhubIndustry }}</p>
                  <p style="font-size: small;"><strong>Webpage:</strong> <a href="{{ searchResult.weburl }}" target="_blank">{{ searchResult.weburl }}</a></p>
                </div>
                
                <p style="font-size: small;"><strong>Company peers:</strong></p>
                <div *ngIf="companypeers && companypeers.peers && companypeers.peers.length > 0">
                  <ng-container *ngFor="let peer of companypeers.peers; let last = last">
                    <a href="#" (click)="getMethod(peer, $event)">{{ peer }}</a>{{last ? '' : ', '}}
                  </ng-container>
                </div>
              </div>
          
            
              <div class="col-12 col-md-6">
                <highcharts-chart
                  [Highcharts]="Highcharts4"
                  [options]="tab1char" 
                  style="width: 100%; height: 400px; display: block;"
                ></highcharts-chart>
              </div>
            </div>
          </div>
          
          </mat-tab>

          



          <mat-tab label="Top News">
            <div class="container mt-4">
              <div class="row">
                <div class="col-12 col-sm-6 mb-4" *ngFor="let item of news">
                 
                  <div class="card h-100 cursor-pointer" (click)="openDialog(item)">
                    <div class="row g-0 h-100">
                      <div class="col-12 col-md-4 d-flex align-items-center justify-content-center">
                       
                        <img src="{{item.image}}" class="img-fluid rounded-start p-3" alt="" style="object-fit: cover; width: 100%; height: 150px;">
                      </div>
                      <div class="col-12 col-md-8 d-flex align-items-stretch">
                        <div class="card-body d-flex flex-column justify-content-center text-center">
                         
                          <p class="mb-0" style="font-size: smaller;">{{item.headline}}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            


          </mat-tab>
          
        <mat-tab label="Charts">

       
         <div class="col-12" *ngIf="loadedstockdata">
         <highcharts-chart
         [Highcharts]="Highcharts4"
         [options]="charttab" 
         style="height: 600px; width: 100%; display: block;"
       ></highcharts-chart>
      </div>


          

           </mat-tab>



        <mat-tab label="Insights" class="col-sm-3">


      
         
            <h2>Insider Sentiments </h2>
            
  
            <div   class="mt-3">
            <table class="table">
              <thead class="thead-light">
                <tr>
                  <th scope="col">{{searchResult.name}}</th>
                  <th scope="col">MSPR</th>
                  <th scope="col">Change</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Total</td>
                  <td>{{ totalMspR | number:'1.0-2' }}</td>
                  <td>{{ totalChange | number:'1.0-2' }}</td>
                </tr>
                <tr>
                  <td>Positive</td>
                  <td>{{ positiveMspR | number:'1.0-2' }}</td>
                  <td>{{ positiveChange | number:'1.0-2' }}</td>
                </tr>
                <tr>
                  <td>Negative</td>
                  <td>{{ negativeMspR | number:'1.0-2' }}</td>
                  <td>{{ negativeChange | number:'1.0-2' }}</td>
                </tr>
              </tbody>
            </table>
            <div class="container">
              <div class="row">
               
                <div class="col-12 col-md-6 ">
                  <highcharts-chart
                    [Highcharts]="Highcharts"
                    [options]="recommendchart"
                    style=" width: 100%; display: block;"
                  ></highcharts-chart>
                </div>

                <div class="col-12 col-md-6 ">
                  <highcharts-chart
                    [Highcharts]="Highcharts2"
                    [options]="earningsChart"
                    style="height: 400px; width: 100%; display: block;"
                  ></highcharts-chart>
                </div>
               
              </div>
            </div>
            </div>
          

         
       
          

          
            
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>

  
</div> 
